<?php
namespace zovye;

use ZipArchive;
use zovye\Util;

$url_tmpl = "https://saas.jspercent.com/app/index.php?i=2&c=entry&app=NULL&from=device&device={uid}&do=entry&m=zy_saas";

$list = [
 "863650067310266",
 "863650067536308",
 "863650067311231",
 "863650067310142",
 "863650067312320",
 "863650067310704",
 "863650067536548",
 "863650067311116",
 "863650067536787",
 "863650067536423",
 "863650067313096",
 "863650067303618",
 "863650067311470",
 "863650067302768",
 "863650067312213",
 "863650067311124",
 "863650067312692",
 "863650067311363",
 "863650067311926",
 "863650067310951",
 "863650067312338",
 "863650067311009",
 "863650067311801",
 "863650067536555",
 "863650067536670",
 "863650067303501",
 "863650067311918",
 "863650067310829",
 "863650067302891",
 "863650067303626",
 "863650067310167",
 "863650067312346",
 "863650067311132",
 "863650067310845",
 "863650067311934",
 "863650067310605",
 "863650067536449",
 "863650067310720",
 "863650067312106",
 "863650067537413",
 "863650067303634",
 "863650067536563",
 "863650067302784",
 "863650067310282",
 "863650067569218",
 "863650067313203",
 "863650067311025",
 "863650067311389",
 "863650067569101",
 "863650067312353",
 "863650067312916",
 "863650067312239",
 "863650067313328",
 "863650067536696",
 "863650067310613",
 "863650067536571",
 "863650067303402",
 "863650067536332",
 "863650067537421",
 "863650067303642",
 "863650067568939",
 "863650067312908",
 "863650067310050",
 "863650067311140",
 "863650067303527",
 "863650067310860",
 "863650067310068",
 "863650067313336",
 "863650067313211",
 "863650067311835",
 "863650067312924",
 "863650067310506",
 "863650067536746",
 "863650067311959",
 "863650067310621",
 "863650067536621",
 "863650067537397",
 "863650067303535",
 "863650067303410",
 "863650067310183",
 "863650067303659",
 "863650067312015",
 "863650067312379",
 "863650067536639",
 "863650067310878",
 "863650067536514",
 "863650067312817",
 "863650067310639",
 "863650067311728",
 "863650067312932",
 "863650067313229",
 "863650067310514",
 "863650067303667",
 "863650067568913",
 "863650067303543",
 "863650067312809",
 "863650067310191",
 "863650067311041",
 "863650067537280",
 "863650067536191",
 "863650067311850",
 "863650067312940",
 "863650067313112",
 "863650067311298",
 "863650067303550",
 "863650067310647",
 "863650067312825",
 "863650067311611",
 "863650067310522",
 "863650067311975",
 "863650067312700",
 "863650067303436",
 "863650067536761",
 "863650067303675",
 "863650067313351",
 "863650067312262",
 "863650067310084",
 "863650067313005",
 "863650067310530",
 "863650067310894",
 "863650067312395",
 "863650067312155",
 "863650067312957",
 "863650067312833",
 "863650067310654",
 "863650067311744",
 "863650067310415",
 "863650067536654",
 "863650067303568",
 "863650067536530",
 "863650067303444",
 "863650067303683",
 "863650067302917",
 "863650067311181",
 "863650067313120",
 "863650067303329",
 "863650067536829",
 "863650067312049",
 "863650067312841",
 "863650067313138",
 "863650067313377",
 "863650067312288",
 "863650067311991",
 "863650067313013",
 "863650067303451",
 "863650067310548",
 "863650067311637",
 "863650067312726",
 "863650067303691",
 "863650067310308",
 "863650067311512",
 "863650067310787",
 "863650067311876",
 "863650067569192",
 "863650067536142",
 "863650067303337",
 "863650067303576",
 "863650067302925",
 "863650067311074",
 "863650067310431",
 "863650067311520",
 "863650067569085",
 "863650067536837",
 "863650067310670",
 "863650067313146",
 "863650067311769",
 "863650067536712",
 "863650067312858",
 "863650067310555",
 "863650067536399",
 "863650067311405",
 "863650067303469",
 "863650067303345",
 "863650067303584",
 "863650067311082",
 "863650067313260",
 "863650067313021",
 "863650067310563",
 "863650067311652",
 "863650067569051",
 "863650067313039",
 "863650067536605",
 "863650067569176",
 "863650067312981",
 "863650067311892",
 "863650067303352",
 "863650067310449",
 "863650067311538",
 "863650067303592",
 "863650067310209",
 "863650067310324",
 "863650067312866",
 "863650067310688",
 "863650067302941",
 "863650067536167",
 "863650067303477",
 "863650067537371",
 "863650067536282",
 "863650067312064",
 "863650067313153",
 "863650067302826",
 "863650067311090",
 "863650067310332",
 "863650067311785",
 "863650067536738",
 "863650067312197",
 "863650067313286",
 "863650067310571",
 "863650067313047",
 "863650067303360",
 "863650067310456",
 "863650067311546",
 "863650067310217",
 "863650067312999",
 "863650067536852",
 "863650067536175",
 "863650067537264",
 "863650067303006",
 "863650067303485",
 "863650067569069",
 "863650067302719",
 "863650067313161",
 "863650067302834",
 "863650067310100",
 "863650067310464",
 "863650067313179",
 "863650067312882",
 "863650067311439",
 "863650067303493",
 "863650067310225",
 "863650067312767",
 "863650067311678",
 "863650067310589",
 "863650067536225",
 "863650067536464",
 "863650067302727",
 "863650067302966",
 "863650067311322",
 "863650067310597",
 "863650067312775",
 "863650067313187",
 "863650067569044",
 "863650067311561",
 "863650067537207",
 "863650067303022",
 "863650067310357",
 "863650067310910",
 "863650067536357",
 "863650067303386",
 "863650067303709",
 "863650067313062",
 "863650067302859",
 "863650067302735",
 "863650067311454",
 "863650067536803",
 "863650067310241",
 "863650067312783",
 "863650067311694",
 "863650067303394",
 "863650067310803",
 "863650067311215",
 "863650067310126",
 "863650067312304",
 "863650067536241",
 "863650067537330",
 "863650067536480",
 "863650067302982",
 "863650067313195",
 "863650067310480",
 "863650067313070",
 "863650067312312",
 "863650067310498",
 "863650067312676",
 "863650067312791",
 "863650067313088",
 "863650067569143",
 "863650067310373",
 "863650067310936",
 "863650067311348",
 "863650067302875",
 "863650067536373",
 "863650067303600",
 "863650067537223",
 "863650067302750",
 "863650067569028",
];

$zip = new ZipArchive();
$zip_filename = ATTACHMENT_ROOT . date('YmdHIs').'.zip';
$zip->open($zip_filename, ZipArchive::CREATE);

foreach($list as $uid) {
    $url = str_replace("{uid}", $uid, $url_tmpl);
    $qrcode_file = Util::createQrcodeFile("device.$uid", $url, function ($filename) use($uid, $zip) {
        Util::renderTxt($filename, $uid);
        $zip->addFile($filename, "$uid.png");
    });
}

$zip->close();

